<!DOCTYPE html>
<html><head><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>qbits.alia documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Alia 1.10.0 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li class="current"><a href="qbits.alia.html"><span>qbits.alia</span></a></li><li><a href="qbits.alia.codec.eaio-uuid.html"><span>qbits.alia.codec.eaio-uuid</span></a></li><li><a href="qbits.alia.codec.joda-time.html"><span>qbits.alia.codec.joda-time</span></a></li><li><a href="qbits.alia.policy.load-balancing.html"><span>qbits.alia.policy.load-balancing</span></a></li><li><a href="qbits.alia.policy.reconnection.html"><span>qbits.alia.policy.reconnection</span></a></li><li><a href="qbits.alia.policy.retry.html"><span>qbits.alia.policy.retry</span></a></li><li><a href="qbits.alia.uuid.html"><span>qbits.alia.uuid</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="qbits.alia.html#var-bind"><span>bind</span></a></li><li><a href="qbits.alia.html#var-cluster"><span>cluster</span></a></li><li><a href="qbits.alia.html#var-connect"><span>connect</span></a></li><li><a href="qbits.alia.html#var-execute"><span>execute</span></a></li><li><a href="qbits.alia.html#var-execute-async"><span>execute-async</span></a></li><li><a href="qbits.alia.html#var-execute-chan"><span>execute-chan</span></a></li><li><a href="qbits.alia.html#var-lazy-query"><span>lazy-query</span></a></li><li><a href="qbits.alia.html#var-prepare"><span>prepare</span></a></li><li><a href="qbits.alia.html#var-set-consistency%21"><span>set-consistency!</span></a></li><li><a href="qbits.alia.html#var-set-executor%21"><span>set-executor!</span></a></li><li><a href="qbits.alia.html#var-set-hayt-query-fn%21"><span>set-hayt-query-fn!</span></a></li><li><a href="qbits.alia.html#var-set-keywordize%21"><span>set-keywordize!</span></a></li><li><a href="qbits.alia.html#var-set-session%21"><span>set-session!</span></a></li><li><a href="qbits.alia.html#var-shutdown"><span>shutdown</span></a></li><li><a href="qbits.alia.html#var-with-consistency"><span>with-consistency</span></a></li><li><a href="qbits.alia.html#var-with-executor"><span>with-executor</span></a></li><li><a href="qbits.alia.html#var-with-session"><span>with-session</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>qbits.alia documentation</h2><pre class="doc"></pre><div class="public" id="var-bind"><h3>bind</h3><div class="usage"><code>(bind statement values)</code></div><pre class="doc">Returns a com.datastax.driver.core.BoundStatement instance to be
used with `execute`</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L131">Source</a></div></div><div class="public" id="var-cluster"><h3>cluster</h3><div class="usage"><code>(cluster hosts &amp; {:as options})</code></div><pre class="doc">Returns a new com.datastax.driver.core/Cluster instance
</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L78">Source</a></div></div><div class="public" id="var-connect"><h3>connect</h3><div class="usage"><code>(connect cluster keyspace)</code><code>(connect cluster)</code></div><pre class="doc">Returns a new com.datastax.driver.core/Session instance. We need to
have this separate in order to allow users to connect to multiple
keyspaces from a single cluster instance</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L85">Source</a></div></div><div class="public" id="var-execute"><h3>execute</h3><div class="usage"><code>(execute &amp; args)</code></div><pre class="doc">Executes a query against a session. Returns a collection of rows.
The first argument can be either a Session instance or the query
directly.

So 2 signatures:

 [session query &amp; {:keys [consistency routing-key retry-policy
                          tracing? values]
                  :or {executor default-async-executor
                       consistency *consistency*}}]

or

 [query &amp; {:keys [consistency routing-key retry-policy
                  tracing? values]
                  :or {executor default-async-executor
                       consistency *consistency*}}]

If you chose the latter the Session must be bound with
`with-session`.

The query can be a raw string, a PreparedStatement (returned by
`prepare`) with values passed as `:values` that will be bound by
`execute`, BoundStatement (returned by `bind`), or a Hayt query.</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L179">Source</a></div></div><div class="public" id="var-execute-async"><h3>execute-async</h3><div class="usage"><code>(execute-async &amp; args)</code></div><pre class="doc">Same as execute, but returns a promise and accepts :success and :error
handlers, you can also pass :executor for the ResultFuture, it
defaults to a cachedThreadPool if you don't</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L218">Source</a></div></div><div class="public" id="var-execute-chan"><h3>execute-chan</h3><div class="usage"><code>(execute-chan &amp; args)</code></div><pre class="doc">Alpha, subject to changes:
Same as execute, but returns a clojure.core.async/chan that is
wired to the underlying ResultSetFuture. This means this is usable
with `go` blocks or `take!`. Exceptions are sent to the
channel as a value, it's your responsability to handle these how you
deem appropriate.</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L249">Source</a></div></div><div class="public" id="var-lazy-query"><h3>lazy-query</h3><div class="usage"><code>(lazy-query &amp; args)</code></div><pre class="doc">Takes a query (hayt, raw or prepared) and a query modifier fn (that
receives the last query and last chunk and returns a new query or nil).
The first chunk will be the original query result, then for each
subsequent chunk the query will be the result of last query
modified by the modifier fn unless the fn returns nil,
which would causes the iteration to stop.

You must pass the session as first argument or
use a binding.  It also accepts any `execute` options as trailing
arguments.

2 signatures:
  [session query pred &amp; opts] or [query pred &amp; opts]

ex: (lazy-query (select :items (limit 2) (where {:x (int 1)}))
                  (fn [q coll]
                    (merge q (where {:si (-&gt; coll last :x inc)})))
                  :consistency :quorum :tracing? true)</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L294">Source</a></div></div><div class="public" id="var-prepare"><h3>prepare</h3><div class="usage"><code>(prepare session query)</code><code>(prepare query)</code></div><pre class="doc">Returns a com.datastax.driver.core.PreparedStatement instance to be
used in `execute` after it's been bound with `bind`. Can take a string query or
a Hayt query, in that case they will be compiled with -&gt;raw internaly.
ex: (prepare (select :foo (where {:bar ?})))</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L113">Source</a></div></div><div class="public" id="var-set-consistency%21"><h3>set-consistency!</h3><div class="usage"></div><pre class="doc">Sets root value of *consistency*
</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L37">Source</a></div></div><div class="public" id="var-set-executor%21"><h3>set-executor!</h3><div class="usage"></div><pre class="doc">Sets root value of *executor*
</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L55">Source</a></div></div><div class="public" id="var-set-hayt-query-fn%21"><h3>set-hayt-query-fn!</h3><div class="usage"></div><pre class="doc">Sets root value of *query-fn*, allowing to control how
hayt queries are executed , defaults to LU with a threshold of 100</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L73">Source</a></div></div><div class="public" id="var-set-keywordize%21"><h3>set-keywordize!</h3><div class="usage"></div><pre class="doc">Sets root value of *keywordize*
</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L67">Source</a></div></div><div class="public" id="var-set-session%21"><h3>set-session!</h3><div class="usage"></div><pre class="doc">Sets root value of *session*
</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L49">Source</a></div></div><div class="public" id="var-shutdown"><h3>shutdown</h3><div class="usage"><code>(shutdown cluster-or-session)</code><code>(shutdown)</code></div><pre class="doc">Shutdowns Session or Cluster instance, clearing the underlying
pools/connections</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L94">Source</a></div></div><div class="public" id="var-with-consistency"><h3>with-consistency</h3><h4 class="macro">macro</h4><div class="usage"><code>(with-consistency consistency &amp; body)</code></div><pre class="doc">Binds qbits.alia/*consistency*
</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L31">Source</a></div></div><div class="public" id="var-with-executor"><h3>with-executor</h3><h4 class="macro">macro</h4><div class="usage"><code>(with-executor executor &amp; body)</code></div><pre class="doc">Binds qbits.alia/*executor*
</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L59">Source</a></div></div><div class="public" id="var-with-session"><h3>with-session</h3><h4 class="macro">macro</h4><div class="usage"><code>(with-session session &amp; body)</code></div><pre class="doc">Binds qbits.alia/*session*
</pre><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/src/qbits/alia.clj#L43">Source</a></div></div></div></body></html>